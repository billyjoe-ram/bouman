<!-- Post card -->
<div class='margindiv'>
    <div class="card" *ngIf="pubType === 'post'; else project" (onload)="gettingId()">
        <!-- Post content and user data -->
        <div class="card-body">
            <div class="row">
                <div class="profile-details col-sm-11 col-md-11 col-lg-11">
                    <!-- User informations -->
                    <img [src]="profileImg" alt="Foto de Perfil" class="profile-picture">
                    <div class="profile-info">
                        {{ profileName }}
                        <span>{{ publication.publishedAt.seconds * 1000 | date: 'd MMM yy'}} </span>
                    </div>
                </div>

                <div class="col-sm-1 col-md-1 col-lg-1" style="padding: 0;">
                    <button id="clear-btn">
                        <img src="../../../../assets/more_vert_black_24dp.svg" alt="Mais">
                    </button>
                </div>
            </div>

            <!-- Post text with text limiting pipe -->
            <p class="card-text">
                {{ publication.content | slice:0:limit }}<span [hidden]="sMDisabled" (click)="showMore()">ver
                    mais...</span>
            </p>
        </div>
        <div class="card-footer">
            <!-- This should be commented out when interactions are implemented -->
            <button class="btn btn-default" (click)="onLikePost(publication)" id="likeButtonPost">
                <span> {{ publication.likes.length }} </span> <img src="/assets/like-gray.svg" alt="Curtir">Curtir
            </button>
            <button class="btn btn-default" (click)="btncomments()" id="commenteButtonPost">
                <img src="/assets/comment-gray.svg" alt="Comentar">Comentar
            </button>
            <!--
        <button class="btn btn-default">
            <img src="/assets/share-gray.svg" alt="Compartilhar">Compartilhar
        </button> -->

        </div>
    </div>
    <div class='commentsSection' *ngIf='isCommentsBtnClicked'>
        <div>
            <p class="commentsHeader"> Comentários </p>
        </div>
        <div *ngIf='!loadingComments'>

            <div *ngFor='let comments of commentsArray'>
                <div class='comment'>
                    <!-- the comment itself-->
                    <div class='row commentuser'>
                        <div class='col-1'>
                            <spinner *ngIf='!pubImgLoaded' class="comment-profile-picture"></spinner>
                            <img *ngIf='pubImgLoaded' [src]="comments.userImg" alt="Foto de Perfil"
                                class="comment-profile-picture">
                        </div>
                        <div class='col-6'>
                            <p> {{ comments.userName }} </p>
                        </div>
                        <div class='col-5 date'>
                            <p> {{ comments.publishedAt.seconds * 1000 | date: 'd MMM yy HH:mm'}} </p>
                        </div>
                    </div>
                    <div class='commentcontent'>
                        <p> {{ comments.content }} </p>
                    </div>
                </div>
            </div>
        </div>
        
    <div *ngIf='loadingComments'>
        <spinner></spinner>
</div>
        <div class='comment-upload'>

            <div class='comment-upload-content'>
                <div class='comment-upload-title'>
                    <p> Comentar:</p>
                </div>
                <form #form="ngForm" (ngSubmit)="comments(form)">
                    <textarea class='form-control comment-input' [(ngModel)]='comment' name='commentarea'
                        placeholder="Digite seu comentário aqui..." required></textarea>
                    <button type="submit" class="btn btn-bouman">Postar</button>
                </form>
            </div>
        </div>
    </div>
</div>
<!-- Project card -->
<ng-template #project>
    <project-card [profileId]="profileId" [project]="publication" [userProfile]='userProfile'></project-card>
</ng-template>